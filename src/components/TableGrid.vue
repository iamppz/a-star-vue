<template>
    <div>
        <van-cell-group v-for="group in groupedData" :key="group[0].TypeName">
            <h2>{{group[0].TypeName}}</h2>
            <template v-for="field in group">
                <van-field v-if="field.inputType === 'text'" :required="field.Required" :label="field.DisplayName"
                           :key="field.uuid" v-model="field.Value" type="text" :disabled="field.ReadOnly"></van-field>
                <van-field-date v-if="field.inputType === 'datetime'" v-model="field.Value" :label="field.DisplayName"
                                :key="field.uuid" :required="field.Required" :readonly="field.ReadOnly"
                                :format="field.Format"></van-field-date>
            </template>
        </van-cell-group>
    </div>
</template>
<script>
    import {CellGroup, Field} from 'vant';
    import VanFieldDate from './VantFieldDate';

    const _ = require('lodash');

    export default {
        data: function () {
            return {
                data: {
                    "表单字段s": [{
                        "Name": "name",
                        "DisplayName": "名称",
                        "DataType": "string",
                        "Value": "北京汇智天源电子工程技术有限公司",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": true,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": true,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "基本信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "contact",
                        "DisplayName": "联系人",
                        "DataType": "string",
                        "Value": "朱晓妮",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": true,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "基本信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "mobile",
                        "DisplayName": "手机",
                        "DataType": "string",
                        "Value": "13911574977，18901160319",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": true,
                        "RegEx": "^1[0-9]{10}$",
                        "Format": "",
                        "UniqueField": true,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "联系信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "gender",
                        "DisplayName": "性别",
                        "DataType": "combobox",
                        "Value": "",
                        "DicTableName": "user_gender",
                        "Identify": false,
                        "DicText": "",
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "基本信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "custom_text_3",
                        "DisplayName": "职务",
                        "DataType": "string",
                        "Value": "",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "基本信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "source",
                        "DisplayName": "客户来源",
                        "DataType": "combobox",
                        "Value": "",
                        "DicTableName": "dict_customer_origin",
                        "Identify": false,
                        "DicText": "",
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "基本信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "investmentHistory",
                        "DisplayName": "重要程度",
                        "DataType": "combobox",
                        "Value": "",
                        "DicTableName": "dict_investment_history",
                        "Identify": false,
                        "DicText": "",
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 3,
                        "TypeName": "基本信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "industry",
                        "DisplayName": "行业",
                        "DataType": "combobox",
                        "Value": "",
                        "DicTableName": "dict_customer_industry",
                        "Identify": false,
                        "DicText": "",
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "基本信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "birthday",
                        "DisplayName": "生日",
                        "DataType": "datetime",
                        "Value": "",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "yyyy-MM-dd",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "基本信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "createTime",
                        "DisplayName": "创建时间",
                        "DataType": "datetime",
                        "Value": "2019-02-27 10:40:35",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "基本信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "departmentId",
                        "DisplayName": "部门",
                        "DataType": "combobox",
                        "Value": "00673e6cc3914bc6a28af134f73df783",
                        "DicTableName": "base_department",
                        "Identify": false,
                        "DicText": "销售",
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": true,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "filter": "category\u003d\u00274\u0027",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "基本信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "intentionCategory",
                        "DisplayName": "咨询产品",
                        "DataType": "multiselect",
                        "Value": "",
                        "DicTableName": "inv_sku",
                        "Identify": false,
                        "DicText": "",
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "需求信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "phone",
                        "DisplayName": "固定电话",
                        "DataType": "string",
                        "Value": "",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "联系信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "custom_text_1",
                        "DisplayName": "QQ号码",
                        "DataType": "string",
                        "Value": "",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "联系信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "email",
                        "DisplayName": "邮箱",
                        "DataType": "string",
                        "Value": "",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "联系信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "custom_text_2",
                        "DisplayName": "公司网址",
                        "DataType": "string",
                        "Value": "",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "联系信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "address",
                        "DisplayName": "地址",
                        "DataType": "string",
                        "Value": "北京市海淀区长春路5号新起点嘉园12楼1001室",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "filter": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "联系信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "province",
                        "DisplayName": "省",
                        "DataType": "string",
                        "Value": "",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": true,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "联系信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "advisorId",
                        "DisplayName": "业务员",
                        "DataType": "combobox",
                        "Value": "d8ecc710fece48d29f5b10c0b551dd5b",
                        "DicTableName": "base_staff",
                        "Identify": false,
                        "DicText": "马朋伟",
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": true,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "基本信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "city",
                        "DisplayName": "市",
                        "DataType": "string",
                        "Value": "",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": true,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "联系信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "custom_text_4",
                        "DisplayName": "规模人数",
                        "DataType": "string",
                        "Value": "",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "需求信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "customerType",
                        "DisplayName": "客户类型",
                        "DataType": "combobox",
                        "Value": "",
                        "DicTableName": "dict_customer_type",
                        "Identify": false,
                        "DicText": "",
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "需求信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "contactStage",
                        "DisplayName": "联系阶段",
                        "DataType": "combobox",
                        "Value": "",
                        "DicTableName": "dict_contact_stage",
                        "Identify": false,
                        "DicText": "",
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": true,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "需求信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "custom_text_5",
                        "DisplayName": "客户预算",
                        "DataType": "string",
                        "Value": "",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "需求信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "availableMoney",
                        "DisplayName": "预计成交金额",
                        "DataType": "combobox",
                        "Value": "",
                        "DicTableName": "dict_investable_assets",
                        "Identify": false,
                        "DicText": "",
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "需求信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "uuid",
                        "DisplayName": "uuid",
                        "DataType": "string",
                        "Value": "b863bc5107eb4388a8f6eb0f3b4a1c59",
                        "DicTableName": "",
                        "Identify": true,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 1,
                        "TypeName": "",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }, {
                        "Name": "remark",
                        "DisplayName": "备注",
                        "DataType": "string",
                        "Value": "波尔云导入",
                        "DicTableName": "",
                        "Identify": false,
                        "DicIndex": -1,
                        "Length": 0,
                        "ReadOnly": false,
                        "Required": false,
                        "RegEx": "",
                        "Format": "",
                        "UniqueField": false,
                        "UniqueGroup": 0,
                        "Colspan": 5,
                        "TypeName": "需求信息",
                        "Color": "",
                        "ParentField": "",
                        "ChildFields": "",
                        "ImportantField": false
                    }]
                }
            }
        },
        watch: {},
        components: {
            [Field.name]: Field,
            [CellGroup.name]: CellGroup,
            [VanFieldDate.name]: VanFieldDate
        },
        computed: {
            groupedData: function () {
                this.data.表单字段s.forEach(field => {
                    switch (field.DataType) {
                        case 'datetime':
                            field.inputType = 'datetime';
                            break;
                        default:
                            field.inputType = 'text';
                            break;
                    }
                })
                return _.groupBy(this.data.表单字段s, item => item.TypeName);
            }
        }
    }
</script>
<style scoped>
    h2 {
        margin: 0;
        font-weight: 400;
        font-size: 1rem;
        color: rgba(69, 90, 100, .6);
        padding: 1rem 1rem 0.4rem;
    }
</style>